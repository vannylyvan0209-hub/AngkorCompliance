<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Committee Analytics - Grievance Committee</title>
    <link rel="icon" type="image/png" href="../../favicon.png">
    <link rel="stylesheet" href="../../assets/css/main-modern.css">
    <link rel="stylesheet" href="../../assets/css/color-system.css">
    <link rel="stylesheet" href="../../assets/css/navigation.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Role-specific styling for grievance_committee */
        body.role-grievance-committee {
            --role-primary: var(--grievance-primary);
            --role-secondary: var(--grievance-secondary);
            --role-accent: var(--grievance-accent);
        }

        
        .analytics-layout { display: flex; min-height: 100vh; background: var(--neutral-50); }
        .main-content { flex: 1; margin-left: 280px; min-height: 100vh; }
        .page-header { background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: var(--space-8); }
        .page-title h1 { font-size: var(--text-4xl); font-weight: 800; margin: 0; display: flex; align-items: center; gap: var(--space-3); }
        .analytics-container { padding: var(--space-8); }
        
        /* Analytics Overview */
        .analytics-overview { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-6); margin-bottom: var(--space-8); }
        .metric-card { background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: var(--shadow-sm); border: 1px solid var(--neutral-200); }
        .metric-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4); }
        .metric-title { font-size: var(--text-lg); font-weight: 600; color: var(--neutral-900); }
        .metric-icon { width: 48px; height: 48px; border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; color: white; }
        .metric-value { font-size: var(--text-3xl); font-weight: 700; color: var(--neutral-900); margin-bottom: var(--space-2); }
        .metric-label { font-size: var(--text-sm); color: var(--neutral-600); }
        .metric-trend { font-size: var(--text-sm); display: flex; align-items: center; gap: var(--space-1); }
        .trend-up { color: var(--success-600); }
        .trend-down { color: var(--error-600); }
        
        /* Charts Grid */
        .charts-grid { display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-8); margin-bottom: var(--space-8); }
        .chart-card { background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: var(--shadow-sm); border: 1px solid var(--neutral-200); }
        .chart-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6); }
        .chart-title { font-size: var(--text-lg); font-weight: 600; color: var(--neutral-900); }
        .chart-actions { display: flex; gap: var(--space-2); }
        
        /* Performance Metrics */
        .performance-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-6); margin-bottom: var(--space-8); }
        .performance-card { background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: var(--shadow-sm); border: 1px solid var(--neutral-200); }
        .performance-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4); }
        .performance-title { font-size: var(--text-lg); font-weight: 600; color: var(--neutral-900); }
        .performance-status { padding: var(--space-1) var(--space-2); border-radius: var(--radius-full); font-size: var(--text-xs); font-weight: 600; }
        .status-excellent { background: var(--success-100); color: var(--success-700); }
        .status-good { background: var(--primary-100); color: var(--primary-700); }
        .status-warning { background: var(--warning-100); color: var(--warning-700); }
        .status-poor { background: var(--error-100); color: var(--error-700); }
        
        /* Investigator Performance */
        .investigator-performance { background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: var(--shadow-sm); border: 1px solid var(--neutral-200); margin-bottom: var(--space-8); }
        .investigator-item { display: flex; align-items: center; gap: var(--space-4); padding: var(--space-4) 0; border-bottom: 1px solid var(--neutral-100); }
        .investigator-item:last-child { border-bottom: none; }
        .investigator-avatar { width: 48px; height: 48px; border-radius: var(--radius-full); background: var(--primary-500); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; }
        .investigator-info { flex: 1; }
        .investigator-name { font-weight: 600; color: var(--neutral-900); margin-bottom: var(--space-1); }
        .investigator-stats { display: flex; gap: var(--space-4); font-size: var(--text-sm); color: var(--neutral-600); }
        .investigator-score { font-size: var(--text-lg); font-weight: 700; color: var(--neutral-900); }
        
        /* Filters */
        .filters-section { background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: var(--shadow-sm); border: 1px solid var(--neutral-200); margin-bottom: var(--space-8); }
        .filters-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); }
        .filter-group { display: flex; flex-direction: column; gap: var(--space-2); }
        .filter-label { font-size: var(--text-sm); font-weight: 600; color: var(--neutral-700); }
        .filter-input { padding: var(--space-2) var(--space-3); border: 1px solid var(--neutral-300); border-radius: var(--radius-lg); font-size: var(--text-sm); }
        
        /* Buttons */
        .btn { padding: var(--space-3) var(--space-6); border-radius: var(--radius-lg); font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; gap: var(--space-2); cursor: pointer; transition: all 0.2s; border: none; font-size: var(--text-sm); }
        .btn-primary { background: var(--primary-600); color: white; }
        .btn-primary:hover { background: var(--primary-700); }
        .btn-outline { background: transparent; color: var(--neutral-700); border: 1px solid var(--neutral-300); }
        .btn-outline:hover { background: var(--neutral-50); }
        .btn-sm { padding: var(--space-2) var(--space-4); font-size: var(--text-xs); }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .main-content { margin-left: 0; }
            .charts-grid { grid-template-columns: 1fr; }
            .analytics-overview { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
        }
        
        @media (max-width: 768px) {
            .page-header { padding: var(--space-6) var(--space-4); }
            .page-title h1 { font-size: var(--text-2xl); }
            .analytics-container { padding: var(--space-4); }
            .analytics-overview { grid-template-columns: 1fr; }
            .performance-grid { grid-template-columns: 1fr; }
            .filters-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body class="role-grievance-committee">
    <div class="analytics-layout">
        <div id="sidebarContainer"></div>
        <script>
            fetch('../../assets/html/sidebar-template.html')
                .then(r => r.text())
                .then(html => {
                    document.getElementById('sidebarContainer').innerHTML = html;
                    const el = document.querySelector('.brand-subtitle');
                    if (el) el.textContent = 'Grievance Committee Portal';
                });
        </script>
        
        <main class="main-content">
            <header class="page-header">
                <div class="page-title">
                    <div>
                        <h1><i data-lucide="bar-chart-3"></i> Committee Analytics</h1>
                        <p>Comprehensive performance metrics and insights for the grievance committee</p>
                    </div>
                    <div style="display: flex; gap: var(--space-4);">
                        <button class="btn btn-outline" onclick="exportAnalytics()">
                            <i data-lucide="download"></i> Export Report
                        </button>
                        <button class="btn btn-primary" onclick="refreshAnalytics()">
                            <i data-lucide="refresh-cw"></i> Refresh Data
                        </button>
                    </div>
                </div>
            </header>
            
            <div class="analytics-container">
                <!-- Filters -->
                <section class="filters-section">
                    <div class="chart-header">
                        <h3 class="chart-title">Analytics Filters</h3>
                        <button class="btn btn-primary btn-sm" onclick="applyFilters()">Apply Filters</button>
                    </div>
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label class="filter-label">Date Range</label>
                            <select class="filter-input" id="dateRange">
                                <option value="last7days">Last 7 Days</option>
                                <option value="last30days">Last 30 Days</option>
                                <option value="last90days">Last 90 Days</option>
                                <option value="last6months">Last 6 Months</option>
                                <option value="last12months">Last 12 Months</option>
                                <option value="custom">Custom Range</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Case Type</label>
                            <select class="filter-input" id="caseType">
                                <option value="all">All Types</option>
                                <option value="harassment">Harassment</option>
                                <option value="safety">Safety</option>
                                <option value="wages">Wages</option>
                                <option value="discrimination">Discrimination</option>
                                <option value="working-conditions">Working Conditions</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Investigator</label>
                            <select class="filter-input" id="investigator">
                                <option value="all">All Investigators</option>
                                <option value="jane-smith">Jane Smith</option>
                                <option value="mike-johnson">Mike Johnson</option>
                                <option value="sarah-wilson">Sarah Wilson</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Priority Level</label>
                            <select class="filter-input" id="priority">
                                <option value="all">All Priorities</option>
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>
                    </div>
                </section>
                
                <!-- Analytics Overview -->
                <section class="analytics-overview">
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3 class="metric-title">Total Cases</h3>
                            <div class="metric-icon" style="background: var(--primary-500);">
                                <i data-lucide="folder"></i>
                            </div>
                        </div>
                        <div class="metric-value" id="totalCases">1,247</div>
                        <div class="metric-label">Cases processed this period</div>
                        <div class="metric-trend trend-up">
                            <i data-lucide="trending-up"></i>
                            <span>+12% from last period</span>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3 class="metric-title">Resolution Rate</h3>
                            <div class="metric-icon" style="background: var(--success-500);">
                                <i data-lucide="check-circle"></i>
                            </div>
                        </div>
                        <div class="metric-value" id="resolutionRate">94.2%</div>
                        <div class="metric-label">Cases successfully resolved</div>
                        <div class="metric-trend trend-up">
                            <i data-lucide="trending-up"></i>
                            <span>+2.1% from last period</span>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3 class="metric-title">Average Resolution Time</h3>
                            <div class="metric-icon" style="background: var(--warning-500);">
                                <i data-lucide="clock"></i>
                            </div>
                        </div>
                        <div class="metric-value" id="avgResolutionTime">6.8 days</div>
                        <div class="metric-label">Time to resolve cases</div>
                        <div class="metric-trend trend-down">
                            <i data-lucide="trending-down"></i>
                            <span>-0.5 days from last period</span>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3 class="metric-title">Worker Satisfaction</h3>
                            <div class="metric-icon" style="background: var(--info-500);">
                                <i data-lucide="smile"></i>
                            </div>
                        </div>
                        <div class="metric-value" id="satisfactionRate">87.5%</div>
                        <div class="metric-label">Satisfaction with outcomes</div>
                        <div class="metric-trend trend-up">
                            <i data-lucide="trending-up"></i>
                            <span>+3.2% from last period</span>
                        </div>
                    </div>
                </section>
                
                <!-- Charts Grid -->
                <section class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">Case Volume Trends</h3>
                            <div class="chart-actions">
                                <button class="btn btn-outline btn-sm" onclick="updateChartPeriod('week')">Week</button>
                                <button class="btn btn-outline btn-sm" onclick="updateChartPeriod('month')">Month</button>
                                <button class="btn btn-outline btn-sm" onclick="updateChartPeriod('quarter')">Quarter</button>
                            </div>
                        </div>
                        <canvas id="caseVolumeChart" width="400" height="200"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">Case Type Distribution</h3>
                        </div>
                        <canvas id="caseTypeChart" width="400" height="200"></canvas>
                    </div>
                </section>
                
                <!-- Performance Metrics -->
                <section class="performance-grid">
                    <div class="performance-card">
                        <div class="performance-header">
                            <h3 class="performance-title">SLA Compliance</h3>
                            <span class="performance-status status-excellent" id="slaStatus">95.8%</span>
                        </div>
                        <div style="font-size: var(--text-2xl); font-weight: 700; color: var(--success-600); margin-bottom: var(--space-2);" id="slaPercentage">95.8%</div>
                        <div style="font-size: var(--text-sm); color: var(--neutral-600);">Cases meeting service level agreements</div>
                        <div style="margin-top: var(--space-4);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Response Time</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">2.3 days</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Resolution Time</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">6.8 days</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Escalation Rate</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">8.2%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-header">
                            <h3 class="performance-title">Quality Metrics</h3>
                            <span class="performance-status status-good" id="qualityStatus">92.3%</span>
                        </div>
                        <div style="font-size: var(--text-2xl); font-weight: 700; color: var(--primary-600); margin-bottom: var(--space-2);" id="qualityPercentage">92.3%</div>
                        <div style="font-size: var(--text-sm); color: var(--neutral-600);">Overall investigation quality score</div>
                        <div style="margin-top: var(--space-4);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Evidence Collection</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">94.1%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Documentation</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">91.7%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Follow-up</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">89.8%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-header">
                            <h3 class="performance-title">Efficiency Metrics</h3>
                            <span class="performance-status status-good" id="efficiencyStatus">88.7%</span>
                        </div>
                        <div style="font-size: var(--text-2xl); font-weight: 700; color: var(--primary-600); margin-bottom: var(--space-2);" id="efficiencyPercentage">88.7%</div>
                        <div style="font-size: var(--text-sm); color: var(--neutral-600);">Operational efficiency score</div>
                        <div style="margin-top: var(--space-4);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Case Load Balance</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">85.2%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Resource Utilization</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">91.3%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: var(--text-sm); color: var(--neutral-600);">Process Automation</span>
                                <span style="font-size: var(--text-sm); font-weight: 600;">89.6%</span>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Investigator Performance -->
                <section class="investigator-performance">
                    <div class="chart-header">
                        <h3 class="chart-title">Investigator Performance</h3>
                        <button class="btn btn-outline btn-sm" onclick="viewAllInvestigators()">View All</button>
                    </div>
                    <div id="investigatorsList">
                        <div class="investigator-item">
                            <div class="investigator-avatar">JS</div>
                            <div class="investigator-info">
                                <div class="investigator-name">Jane Smith</div>
                                <div class="investigator-stats">
                                    <span>Cases: 45</span>
                                    <span>Resolution Rate: 96.2%</span>
                                    <span>Avg Time: 5.8 days</span>
                                </div>
                            </div>
                            <div class="investigator-score">94.5</div>
                        </div>
                        <div class="investigator-item">
                            <div class="investigator-avatar">MJ</div>
                            <div class="investigator-info">
                                <div class="investigator-name">Mike Johnson</div>
                                <div class="investigator-stats">
                                    <span>Cases: 38</span>
                                    <span>Resolution Rate: 92.1%</span>
                                    <span>Avg Time: 7.2 days</span>
                                </div>
                            </div>
                            <div class="investigator-score">89.3</div>
                        </div>
                        <div class="investigator-item">
                            <div class="investigator-avatar">SW</div>
                            <div class="investigator-info">
                                <div class="investigator-name">Sarah Wilson</div>
                                <div class="investigator-stats">
                                    <span>Cases: 42</span>
                                    <span>Resolution Rate: 94.7%</span>
                                    <span>Avg Time: 6.1 days</span>
                                </div>
                            </div>
                            <div class="investigator-score">91.8</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script type="module" src="../../firebase-config.js"></script>
    <script src="../../assets/js/grievance-committee/committee-analytics.js"></script>
    <script src="../../assets/js/nav-config.js"></script>
    <script src="../../assets/js/navigation-component.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize navigation system
            const navigation = new NavigationComponent();
            navigation.init();
            if (window.lucide) {
                lucide.createIcons();
            }
        });
    </script>
</body>
</html>
