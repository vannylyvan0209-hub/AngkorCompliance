<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="../../assets/css/main-2025.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factory Admin Settings - Angkor Compliance</title>
    <link rel="stylesheet" href="../../assets/css/styles.css">
    
    

    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="../../assets/js/universal-navigation.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../../assets/js/universal-navigation.js"></script>
</head>
<body>
    <div id="sidebarContainer"></div>
    <div class="app-container">
        <!-- Header -->
        <header class="mb-8 pb-6 border-b border-neutral-200">
            <div class="header-content">
                <div class="header-left">
                    <h1>Factory Admin Settings</h1>
                    <p>Manage your factory's compliance settings and configurations</p>
                </div>
                <div class="header-right">
                    <div class="user-menu">
                        <span id="userName">Loading...</span>
                        <button onclick="logout()" class="btn btn-outline">Logout</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="layout-main">
        <div style="margin-left: 280px;">
            <div class="settings-container">
                <!-- Settings Navigation -->
                <nav class="settings-nav">
                    <button class="nav-item active" onclick="showTab('general')">
                        <i data-lucide="settings"></i>
                        General Settings
                    </button>
                    <button class="nav-item" onclick="showTab('factory')">
                        <i data-lucide="building"></i>
                        Factory Management
                    </button>
                    <button class="nav-item" onclick="showTab('users')">
                        <i data-lucide="users"></i>
                        User Management
                    </button>
                    <button class="nav-item" onclick="showTab('compliance')">
                        <i data-lucide="shield-check"></i>
                        Compliance Standards
                    </button>
                    <button class="nav-item" onclick="showTab('notifications')">
                        <i data-lucide="bell"></i>
                        Notifications
                    </button>
                    <button class="nav-item" onclick="showTab('reports')">
                        <i data-lucide="bar-chart-3"></i>
                        Reports & Analytics
                    </button>
                    <button class="nav-item" onclick="showTab('audit')">
                        <i data-lucide="file-text"></i>
                        Audit Log
                    </button>
                </nav>

                <!-- Settings Content -->
                <div class="settings-content">
                    <!-- General Settings Tab -->
                    <div id="general" class="tab-content active">
                        <div class="tab-header">
                            <h2>General Settings</h2>
                            <p>Configure basic factory settings and preferences</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Factory Information</h3>
                                <form id="factoryInfoForm">
                                    <div class="form-group">
                                        <label for="factoryName">Factory Name</label>
                                        <input type="text" id="factoryName" name="factoryName" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="factoryAddress">Address</label>
                                        <textarea id="factoryAddress" name="factoryAddress" rows="3"></textarea>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="factoryPhone">Phone</label>
                                            <input type="tel" id="factoryPhone" name="factoryPhone">
                                        </div>
                                        <div class="form-group">
                                            <label for="factoryEmail">Email</label>
                                            <input type="email" id="factoryEmail" name="factoryEmail">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="factoryIndustry">Industry</label>
                                        <select id="factoryIndustry" name="factoryIndustry">
                                            <option value="">Select Industry</option>
                                            <option value="textiles">Textiles & Garments</option>
                                            <option value="electronics">Electronics</option>
                                            <option value="footwear">Footwear</option>
                                            <option value="furniture">Furniture</option>
                                            <option value="food">Food & Beverage</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>

                            <div class="setting-card">
                                <h3>Regional Settings</h3>
                                <form id="regionalForm">
                                    <div class="form-group">
                                        <label for="timezone">Timezone</label>
                                        <select id="timezone" name="timezone">
                                            <option value="Asia/Phnom_Penh">Asia/Phnom Penh (GMT+7)</option>
                                            <option value="Asia/Bangkok">Asia/Bangkok (GMT+7)</option>
                                            <option value="Asia/Ho_Chi_Minh">Asia/Ho Chi Minh (GMT+7)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="language">Language</label>
                                        <select id="language" name="language">
                                            <option value="en">English</option>
                                            <option value="km">ខ្មែរ (Khmer)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="currency">Currency</label>
                                        <select id="currency" name="currency">
                                            <option value="USD">USD ($)</option>
                                            <option value="KHR">KHR (៛)</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Factory Management Tab -->
                    <div id="factory" class="tab-content">
                        <div class="tab-header">
                            <h2>Factory Management</h2>
                            <p>Manage factory operations and workforce</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Workforce Information</h3>
                                <form id="workforceForm">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="totalWorkers">Total Workers</label>
                                            <input type="number" id="totalWorkers" name="totalWorkers" min="0">
                                        </div>
                                        <div class="form-group">
                                            <label for="femaleWorkers">Female Workers</label>
                                            <input type="number" id="femaleWorkers" name="femaleWorkers" min="0">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="maleWorkers">Male Workers</label>
                                            <input type="number" id="maleWorkers" name="maleWorkers" min="0">
                                        </div>
                                        <div class="form-group">
                                            <label for="underageWorkers">Underage Workers (0)</label>
                                            <input type="number" id="underageWorkers" name="underageWorkers" min="0" value="0">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="workingHours">Standard Working Hours</label>
                                        <input type="number" id="workingHours" name="workingHours" min="0" max="24" value="8">
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>

                            <div class="setting-card">
                                <h3>Production Information</h3>
                                <form id="productionForm">
                                    <div class="form-group">
                                        <label for="productionCapacity">Production Capacity</label>
                                        <input type="text" id="productionCapacity" name="productionCapacity" placeholder="e.g., 10,000 units/month">
                                    </div>
                                    <div class="form-group">
                                        <label for="mainProducts">Main Products</label>
                                        <textarea id="mainProducts" name="mainProducts" rows="3" placeholder="List main products"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label for="certifications">Certifications</label>
                                        <textarea id="certifications" name="certifications" rows="3" placeholder="List certifications"></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- User Management Tab -->
                    <div id="users" class="tab-content">
                        <div class="tab-header">
                            <h2>User Management</h2>
                            <p>Manage factory users and permissions</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Factory Users</h3>
                                <div class="table-container">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Role</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="factoryUsersTable">
                                            <tr>
                                                <td colspan="5" class="text-center text-neutral-900">Loading users...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <button onclick="openAddUserModal()" class="btn btn-primary text-white font-medium">Add New User</button>
                            </div>

                            <div class="setting-card">
                                <h3>User Statistics</h3>
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-value" id="totalUsers">0</div>
                                        <div class="stat-label">Total Users</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="activeUsers">0</div>
                                        <div class="stat-label">Active Users</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="hrUsers">0</div>
                                        <div class="stat-label">HR Staff</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="auditorUsers">0</div>
                                        <div class="stat-label">Auditors</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Compliance Standards Tab -->
                    <div id="compliance" class="tab-content">
                        <div class="tab-header">
                            <h2>Compliance Standards</h2>
                            <p>Configure compliance requirements and standards</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Document Categories</h3>
                                <div class="category-list" id="documentCategories">
                                    <!-- Categories will be loaded here -->
                                </div>
                                <button onclick="openAddCategoryModal()" class="btn btn-primary text-white font-medium">Add Category</button>
                            </div>

                            <div class="setting-card">
                                <h3>Compliance Requirements</h3>
                                <form id="complianceForm">
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="laborStandards" value="true">
                                            Labor Standards Compliance
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="safetyStandards" value="true">
                                            Safety Standards Compliance
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="environmentalStandards" value="true">
                                            Environmental Standards Compliance
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="qualityStandards" value="true">
                                            Quality Standards Compliance
                                        </label>
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Tab -->
                    <div id="notifications" class="tab-content">
                        <div class="tab-header">
                            <h2>Notification Settings</h2>
                            <p>Configure notification preferences</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Email Notifications</h3>
                                <form id="emailNotificationsForm">
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="documentExpiry" value="true">
                                            Document Expiry Alerts
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="capDueDate" value="true">
                                            CAP Due Date Reminders
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="newGrievances" value="true">
                                            New Grievance Notifications
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="complianceBreaches" value="true">
                                            Compliance Breach Alerts
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label for="notificationEmail">Notification Email</label>
                                        <input type="email" id="notificationEmail" name="notificationEmail">
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>

                            <div class="setting-card">
                                <h3>System Notifications</h3>
                                <form id="systemNotificationsForm">
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="soundEnabled" value="true">
                                            Enable Sound Notifications
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="desktopNotifications" value="true">
                                            Enable Desktop Notifications
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" name="autoDismiss" value="true">
                                            Auto-dismiss Notifications
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label for="dismissDelay">Dismiss Delay (seconds)</label>
                                        <input type="number" id="dismissDelay" name="dismissDelay" min="1" max="60" value="5">
                                    </div>
                                    <button type="submit" class="btn btn-primary text-white font-medium">Save Changes</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Reports & Analytics Tab -->
                    <div id="reports" class="tab-content">
                        <div class="tab-header">
                            <h2>Reports & Analytics</h2>
                            <p>Generate reports and view analytics</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Factory Performance</h3>
                                <div class="chart-container">
                                    <canvas id="factoryPerformanceChart"></canvas>
                                </div>
                                <div class="chart-actions">
                                    <button onclick="generateFactoryReport()" class="btn btn-primary text-white font-medium">Generate Report</button>
                                    <button onclick="exportFactoryData()" class="btn btn-outline">Export Data</button>
                                </div>
                            </div>

                            <div class="setting-card">
                                <h3>Compliance Metrics</h3>
                                <div class="metrics-grid">
                                    <div class="metric-card">
                                        <div class="metric-value" id="complianceScore">0%</div>
                                        <div class="metric-label">Overall Compliance</div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-value" id="documentHealth">0%</div>
                                        <div class="metric-label">Document Health</div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-value" id="capCompletion">0%</div>
                                        <div class="metric-label">CAP Completion</div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-value" id="grievanceResolution">0%</div>
                                        <div class="metric-label">Grievance Resolution</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Audit Log Tab -->
                    <div id="audit" class="tab-content">
                        <div class="tab-header">
                            <h2>Audit Log</h2>
                            <p>View system activity and audit trail</p>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card full-width">
                                <h3>Factory Activity Log</h3>
                                <div class="table-container">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Timestamp</th>
                                                <th>User</th>
                                                <th>Action</th>
                                                <th>Details</th>
                                                <th>IP Address</th>
                                            </tr>
                                        </thead>
                                        <tbody id="auditLogTable">
                                            <tr>
                                                <td colspan="5" class="text-center text-neutral-900">Loading audit log...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="table-actions">
                                    <button onclick="exportAuditLog()" class="btn btn-outline">Export Log</button>
                                    <button onclick="clearAuditLog()" class="btn btn-danger text-white font-medium">Clear Log</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                </div>
</main>
    </div>

    <!-- Add User Modal -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New User</h3>
                <button onclick="closeModal('addUserModal')" class="modal-close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addUserForm">
                    <div class="form-group">
                        <label for="newUserName">Full Name</label>
                        <input type="text" id="newUserName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="newUserEmail">Email</label>
                        <input type="email" id="newUserEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="newUserRole">Role</label>
                        <select id="newUserRole" name="role" required>
                            <option value="">Select Role</option>
                            <option value="hr_staff">HR Staff</option>
                            <option value="auditor">Auditor</option>
                            <option value="viewer">Viewer</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="newUserDepartment">Department</label>
                        <input type="text" id="newUserDepartment" name="department">
                    </div>
                    <div class="form-group">
                        <label for="newUserNotes">Notes</label>
                        <textarea id="newUserNotes" name="notes" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('addUserModal')" class="btn btn-outline">Cancel</button>
                <button onclick="saveNewUser()" class="btn btn-primary text-white font-medium">Add User</button>
            </div>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div id="addCategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Document Category</h3>
                <button onclick="closeModal('addCategoryModal')" class="modal-close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addCategoryForm">
                    <div class="form-group">
                        <label for="categoryName">Category Name</label>
                        <input type="text" id="categoryName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="categoryDescription">Description</label>
                        <textarea id="categoryDescription" name="description" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="categoryColor">Color</label>
                        <input type="color" id="categoryColor" name="color" value="#3B82F6">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('addCategoryModal')" class="btn btn-outline">Cancel</button>
                <button onclick="saveNewCategory()" class="btn btn-primary text-white font-medium">Add Category</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="firebase-config.js"></script>
    <script src="../../assets/js/universal-navigation.js"></script>
    <script src="../../assets/js/notification-system.js"></script>
    <script src="../../assets/js/universal-navigation.js"></script>
    <script src="../../assets/js/advanced-analytics.js"></script>
    <script src="../../assets/js/universal-navigation.js"></script>
    <script src="../../assets/js/factory-admin-settings.js"></script>
    <script src="../../assets/js/universal-navigation.js"></script>
</body>
</html>


