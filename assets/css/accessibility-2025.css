/**
 * Angkor Compliance Platform - Accessibility System 2025
 * 
 * WCAG 2.1 AA compliance features, accessibility enhancements,
 * and inclusive design patterns for the 2025 design system.
 */

/* ===== FOCUS MANAGEMENT ===== */

/* Focus Visible */
*:focus-visible {
    outline: 2px solid var(--primary-500);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
}

/* Focus Ring for Interactive Elements */
.btn:focus-visible,
.form-input:focus-visible,
.form-textarea:focus-visible,
.form-select:focus-visible,
.form-checkbox input[type="checkbox"]:focus-visible + .checkbox-custom,
.form-radio input[type="radio"]:focus-visible + .radio-custom,
.form-switch input[type="checkbox"]:focus-visible + .switch-custom,
.nav-item:focus-visible,
.card:focus-visible,
.avatar-interactive:focus-visible,
.alert-close:focus-visible,
.toast-close:focus-visible,
.banner-close:focus-visible,
.inline-notification-close:focus-visible {
    outline: 2px solid var(--primary-500);
    outline-offset: 2px;
}

/* Skip Links */
.skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--primary-500);
    color: white;
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-md);
    text-decoration: none;
    font-weight: var(--font-semibold);
    z-index: var(--z-skip-link);
    transition: top 0.3s ease;
}

.skip-link:focus {
    top: 6px;
}

/* Focus Trap */
.focus-trap {
    position: relative;
}

.focus-trap::before,
.focus-trap::after {
    content: '';
    position: absolute;
    width: 1px;
    height: 1px;
    opacity: 0;
    pointer-events: none;
}

.focus-trap::before {
    top: -1px;
    left: -1px;
}

.focus-trap::after {
    bottom: -1px;
    right: -1px;
}

/* ===== COLOR CONTRAST ENHANCEMENTS ===== */

/* High Contrast Mode */
@media (prefers-contrast: high) {
    :root {
        --primary-500: #000000;
        --primary-600: #000000;
        --primary-700: #000000;
        --neutral-700: #000000;
        --neutral-800: #000000;
        --neutral-900: #000000;
        --success-500: #006600;
        --warning-500: #cc6600;
        --danger-500: #cc0000;
        --info-500: #0066cc;
    }
    
    .btn {
        border-width: 2px;
        border-color: currentColor;
    }
    
    .form-input,
    .form-textarea,
    .form-select {
        border-width: 2px;
    }
    
    .card {
        border-width: 2px;
    }
    
    .alert,
    .toast,
    .banner,
    .inline-notification {
        border-width: 2px;
    }
    
    .progress-bar {
        border: 2px solid var(--neutral-900);
    }
    
    .avatar {
        border: 2px solid var(--neutral-900);
    }
}

/* Color Blind Friendly Enhancements */
.colorblind-friendly {
    --success-500: #2d5a2d;
    --warning-500: #8b5a00;
    --danger-500: #8b0000;
    --info-500: #1e3a8a;
}

/* ===== REDUCED MOTION ===== */

/* Respect User's Motion Preferences */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    .btn:hover,
    .card:hover,
    .avatar-interactive:hover,
    .nav-item:hover {
        transform: none !important;
    }
    
    .btn:active,
    .card:active,
    .avatar-interactive:active {
        transform: none !important;
    }
    
    .spinner,
    .progress-bar::before,
    .loading-bar-progress::before,
    .skeleton {
        animation: none !important;
    }
    
    .alert-animated,
    .toast,
    .modal {
        animation: none !important;
    }
}

/* ===== SCREEN READER SUPPORT ===== */

/* Screen Reader Only Content */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

.sr-only-focusable:focus {
    position: static;
    width: auto;
    height: auto;
    padding: inherit;
    margin: inherit;
    overflow: visible;
    clip: auto;
    white-space: normal;
}

/* Screen Reader Announcements */
.sr-announce {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
}

/* ===== ARIA SUPPORT ===== */

/* ARIA Live Regions */
.aria-live {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
}

.aria-live-polite {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
}

.aria-live-assertive {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
}

/* ARIA Hidden */
.aria-hidden {
    display: none !important;
}

/* ===== KEYBOARD NAVIGATION ===== */

/* Keyboard Navigation Indicators */
.keyboard-nav .btn:focus,
.keyboard-nav .form-input:focus,
.keyboard-nav .form-textarea:focus,
.keyboard-nav .form-select:focus,
.keyboard-nav .nav-item:focus,
.keyboard-nav .card:focus,
.keyboard-nav .avatar-interactive:focus {
    outline: 3px solid var(--primary-500);
    outline-offset: 3px;
    box-shadow: 0 0 0 6px rgba(212, 175, 55, 0.2);
}

/* Tab Order Management */
.tab-order-1 { order: 1; }
.tab-order-2 { order: 2; }
.tab-order-3 { order: 3; }
.tab-order-4 { order: 4; }
.tab-order-5 { order: 5; }
.tab-order-6 { order: 6; }
.tab-order-7 { order: 7; }
.tab-order-8 { order: 8; }
.tab-order-9 { order: 9; }
.tab-order-10 { order: 10; }

/* ===== TOUCH TARGETS ===== */

/* Minimum Touch Target Size */
.touch-target {
    min-height: 44px;
    min-width: 44px;
}

.touch-target-sm {
    min-height: 36px;
    min-width: 36px;
}

.touch-target-lg {
    min-height: 56px;
    min-width: 56px;
}

/* Touch Target Spacing */
.touch-spacing {
    padding: var(--space-3);
    margin: var(--space-2);
}

.touch-spacing-sm {
    padding: var(--space-2);
    margin: var(--space-1);
}

.touch-spacing-lg {
    padding: var(--space-4);
    margin: var(--space-3);
}

/* ===== TEXT ACCESSIBILITY ===== */

/* Text Size Scaling */
.text-scale-sm {
    font-size: 0.875rem;
}

.text-scale-base {
    font-size: 1rem;
}

.text-scale-lg {
    font-size: 1.125rem;
}

.text-scale-xl {
    font-size: 1.25rem;
}

/* Line Height for Readability */
.text-readable {
    line-height: 1.6;
}

.text-readable-sm {
    line-height: 1.5;
}

.text-readable-lg {
    line-height: 1.7;
}

/* Letter Spacing for Readability */
.text-spaced {
    letter-spacing: 0.05em;
}

.text-spaced-sm {
    letter-spacing: 0.025em;
}

.text-spaced-lg {
    letter-spacing: 0.075em;
}

/* ===== FORM ACCESSIBILITY ===== */

/* Required Field Indicators */
.form-label-required::after {
    content: ' *';
    color: var(--danger-500);
    font-weight: var(--font-bold);
}

.form-label-optional::after {
    content: ' (optional)';
    color: var(--neutral-500);
    font-weight: var(--font-normal);
    font-size: var(--text-xs);
}

/* Error Messages */
.form-error {
    color: var(--danger-600);
    font-size: var(--text-sm);
    margin-top: var(--space-1);
    display: flex;
    align-items: center;
    gap: var(--space-1);
}

.form-error::before {
    content: '⚠';
    font-size: var(--text-sm);
}

/* Success Messages */
.form-success {
    color: var(--success-600);
    font-size: var(--text-sm);
    margin-top: var(--space-1);
    display: flex;
    align-items: center;
    gap: var(--space-1);
}

.form-success::before {
    content: '✓';
    font-size: var(--text-sm);
}

/* Fieldset and Legend */
.form-fieldset {
    border: 1px solid var(--neutral-300);
    border-radius: var(--radius-md);
    padding: var(--space-4);
    margin-bottom: var(--space-4);
}

.form-legend {
    font-weight: var(--font-semibold);
    font-size: var(--text-sm);
    color: var(--neutral-700);
    padding: 0 var(--space-2);
    margin-bottom: var(--space-2);
}

/* ===== NAVIGATION ACCESSIBILITY ===== */

/* Navigation Landmarks */
.nav-landmark {
    role: navigation;
}

.nav-landmark[aria-label] {
    /* Navigation with explicit label */
}

.nav-landmark[aria-labelledby] {
    /* Navigation with referenced label */
}

/* Breadcrumb Navigation */
.breadcrumb {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    font-size: var(--text-sm);
    color: var(--neutral-600);
}

.breadcrumb-item {
    display: flex;
    align-items: center;
    gap: var(--space-1);
}

.breadcrumb-item:not(:last-child)::after {
    content: '>';
    margin-left: var(--space-1);
    color: var(--neutral-400);
}

.breadcrumb-item a {
    color: var(--primary-600);
    text-decoration: none;
}

.breadcrumb-item a:hover {
    text-decoration: underline;
}

.breadcrumb-item[aria-current="page"] {
    color: var(--neutral-700);
    font-weight: var(--font-medium);
}

/* ===== MODAL ACCESSIBILITY ===== */

/* Modal Focus Management */
.modal[aria-hidden="true"] {
    display: none;
}

.modal[aria-hidden="false"] {
    display: block;
}

/* Modal Backdrop */
.modal-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: var(--z-modal-backdrop);
}

/* Modal Focus Trap */
.modal-focus-trap {
    position: relative;
}

.modal-focus-trap::before,
.modal-focus-trap::after {
    content: '';
    position: absolute;
    width: 1px;
    height: 1px;
    opacity: 0;
    pointer-events: none;
}

.modal-focus-trap::before {
    top: -1px;
    left: -1px;
}

.modal-focus-trap::after {
    bottom: -1px;
    right: -1px;
}

/* ===== TABLE ACCESSIBILITY ===== */

/* Table Captions */
.table-caption {
    caption-side: top;
    text-align: left;
    font-weight: var(--font-semibold);
    font-size: var(--text-lg);
    color: var(--neutral-700);
    margin-bottom: var(--space-2);
}

/* Table Headers */
.table-header {
    background: var(--neutral-100);
    font-weight: var(--font-semibold);
    color: var(--neutral-700);
    text-align: left;
    padding: var(--space-3);
    border-bottom: 1px solid var(--neutral-300);
}

/* Table Cells */
.table-cell {
    padding: var(--space-3);
    border-bottom: 1px solid var(--neutral-200);
    vertical-align: top;
}

/* Table Row Headers */
.table-row-header {
    font-weight: var(--font-medium);
    color: var(--neutral-700);
    background: var(--neutral-50);
}

/* ===== IMAGE ACCESSIBILITY ===== */

/* Decorative Images */
.img-decorative {
    role: presentation;
    alt: '';
}

/* Informative Images */
.img-informative {
    alt: 'Descriptive text for screen readers';
}

/* Complex Images */
.img-complex {
    role: img;
    aria-labelledby: 'image-description';
}

.img-complex-description {
    id: 'image-description';
    class: 'sr-only';
}

/* ===== VIDEO ACCESSIBILITY ===== */

/* Video Controls */
.video-controls {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2);
    background: var(--neutral-100);
    border-radius: var(--radius-md);
}

.video-control-button {
    background: none;
    border: none;
    padding: var(--space-2);
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--neutral-700);
    transition: var(--transition-colors);
}

.video-control-button:hover {
    background: var(--neutral-200);
    color: var(--neutral-800);
}

.video-control-button:focus-visible {
    outline: 2px solid var(--primary-500);
    outline-offset: 2px;
}

/* ===== AUDIO ACCESSIBILITY ===== */

/* Audio Controls */
.audio-controls {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2);
    background: var(--neutral-100);
    border-radius: var(--radius-md);
}

.audio-control-button {
    background: none;
    border: none;
    padding: var(--space-2);
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--neutral-700);
    transition: var(--transition-colors);
}

.audio-control-button:hover {
    background: var(--neutral-200);
    color: var(--neutral-800);
}

.audio-control-button:focus-visible {
    outline: 2px solid var(--primary-500);
    outline-offset: 2px;
}

/* ===== RESPONSIVE ACCESSIBILITY ===== */

@media (max-width: 768px) {
    .skip-link {
        left: var(--space-2);
        top: -40px;
    }
    
    .skip-link:focus {
        top: var(--space-2);
    }
    
    .touch-target {
        min-height: 48px;
        min-width: 48px;
    }
    
    .touch-target-sm {
        min-height: 40px;
        min-width: 40px;
    }
    
    .touch-target-lg {
        min-height: 56px;
        min-width: 56px;
    }
}

/* ===== DARK MODE ACCESSIBILITY ===== */

@media (prefers-color-scheme: dark) {
    .skip-link {
        background: var(--dark-primary-500);
        color: var(--dark-text-inverse);
    }
    
    *:focus-visible {
        outline-color: var(--dark-primary-500);
    }
    
    .btn:focus-visible,
    .form-input:focus-visible,
    .form-textarea:focus-visible,
    .form-select:focus-visible,
    .nav-item:focus-visible,
    .card:focus-visible,
    .avatar-interactive:focus-visible {
        outline-color: var(--dark-primary-500);
    }
    
    .keyboard-nav .btn:focus,
    .keyboard-nav .form-input:focus,
    .keyboard-nav .form-textarea:focus,
    .keyboard-nav .form-select:focus,
    .keyboard-nav .nav-item:focus,
    .keyboard-nav .card:focus,
    .keyboard-nav .avatar-interactive:focus {
        outline-color: var(--dark-primary-500);
        box-shadow: 0 0 0 6px rgba(212, 175, 55, 0.2);
    }
    
    .form-label-required::after {
        color: var(--dark-danger-500);
    }
    
    .form-label-optional::after {
        color: var(--dark-neutral-500);
    }
    
    .form-error {
        color: var(--dark-danger-400);
    }
    
    .form-success {
        color: var(--dark-success-400);
    }
    
    .form-fieldset {
        border-color: var(--dark-neutral-300);
    }
    
    .form-legend {
        color: var(--dark-neutral-300);
    }
    
    .breadcrumb {
        color: var(--dark-neutral-400);
    }
    
    .breadcrumb-item:not(:last-child)::after {
        color: var(--dark-neutral-500);
    }
    
    .breadcrumb-item a {
        color: var(--dark-primary-400);
    }
    
    .breadcrumb-item[aria-current="page"] {
        color: var(--dark-neutral-300);
    }
    
    .table-caption {
        color: var(--dark-neutral-300);
    }
    
    .table-header {
        background: var(--dark-neutral-100);
        color: var(--dark-neutral-300);
        border-bottom-color: var(--dark-neutral-300);
    }
    
    .table-cell {
        border-bottom-color: var(--dark-neutral-200);
    }
    
    .table-row-header {
        color: var(--dark-neutral-300);
        background: var(--dark-neutral-50);
    }
    
    .video-controls,
    .audio-controls {
        background: var(--dark-neutral-100);
    }
    
    .video-control-button,
    .audio-control-button {
        color: var(--dark-neutral-300);
    }
    
    .video-control-button:hover,
    .audio-control-button:hover {
        background: var(--dark-neutral-200);
        color: var(--dark-neutral-200);
    }
}

.dark-mode .skip-link {
    background: var(--dark-primary-500);
    color: var(--dark-text-inverse);
}

.dark-mode *:focus-visible {
    outline-color: var(--dark-primary-500);
}

.dark-mode .btn:focus-visible,
.dark-mode .form-input:focus-visible,
.dark-mode .form-textarea:focus-visible,
.dark-mode .form-select:focus-visible,
.dark-mode .nav-item:focus-visible,
.dark-mode .card:focus-visible,
.dark-mode .avatar-interactive:focus-visible {
    outline-color: var(--dark-primary-500);
}

.dark-mode .keyboard-nav .btn:focus,
.dark-mode .keyboard-nav .form-input:focus,
.dark-mode .keyboard-nav .form-textarea:focus,
.dark-mode .keyboard-nav .form-select:focus,
.dark-mode .keyboard-nav .nav-item:focus,
.dark-mode .keyboard-nav .card:focus,
.dark-mode .keyboard-nav .avatar-interactive:focus {
    outline-color: var(--dark-primary-500);
    box-shadow: 0 0 0 6px rgba(212, 175, 55, 0.2);
}

.dark-mode .form-label-required::after {
    color: var(--dark-danger-500);
}

.dark-mode .form-label-optional::after {
    color: var(--dark-neutral-500);
}

.dark-mode .form-error {
    color: var(--dark-danger-400);
}

.dark-mode .form-success {
    color: var(--dark-success-400);
}

.dark-mode .form-fieldset {
    border-color: var(--dark-neutral-300);
}

.dark-mode .form-legend {
    color: var(--dark-neutral-300);
}

.dark-mode .breadcrumb {
    color: var(--dark-neutral-400);
}

.dark-mode .breadcrumb-item:not(:last-child)::after {
    color: var(--dark-neutral-500);
}

.dark-mode .breadcrumb-item a {
    color: var(--dark-primary-400);
}

.dark-mode .breadcrumb-item[aria-current="page"] {
    color: var(--dark-neutral-300);
}

.dark-mode .table-caption {
    color: var(--dark-neutral-300);
}

.dark-mode .table-header {
    background: var(--dark-neutral-100);
    color: var(--dark-neutral-300);
    border-bottom-color: var(--dark-neutral-300);
}

.dark-mode .table-cell {
    border-bottom-color: var(--dark-neutral-200);
}

.dark-mode .table-row-header {
    color: var(--dark-neutral-300);
    background: var(--dark-neutral-50);
}

.dark-mode .video-controls,
.dark-mode .audio-controls {
    background: var(--dark-neutral-100);
}

.dark-mode .video-control-button,
.dark-mode .audio-control-button {
    color: var(--dark-neutral-300);
}

.dark-mode .video-control-button:hover,
.dark-mode .audio-control-button:hover {
    background: var(--dark-neutral-200);
    color: var(--dark-neutral-200);
}

/* ===== ACCESSIBILITY UTILITIES ===== */

/* Hide from Screen Readers */
.aria-hidden {
    display: none !important;
}

/* Show to Screen Readers Only */
.aria-visible {
    position: static !important;
    width: auto !important;
    height: auto !important;
    padding: inherit !important;
    margin: inherit !important;
    overflow: visible !important;
    clip: auto !important;
    white-space: normal !important;
}

/* Accessibility Testing Helpers */
.a11y-test {
    border: 2px dashed red !important;
    background: rgba(255, 0, 0, 0.1) !important;
}

.a11y-test::before {
    content: 'A11Y TEST';
    position: absolute;
    top: -20px;
    left: 0;
    background: red;
    color: white;
    padding: 2px 4px;
    font-size: 10px;
    font-weight: bold;
    z-index: 9999;
}
